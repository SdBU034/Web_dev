function Banner(){this.bannerWidth=800,this.bannerGroup=$("#banner-group"),this.index=1,this.leftArrow=$(".left-arrow"),this.rightArrow=$(".right-arrow"),this.bannerUl=$("#banner-ul"),this.liList=this.bannerUl.children("li"),this.bannerCount=this.liList.length,this.pageControl=$(".page-control")}function Index(){var n=this;n.page=2,n.category_id=0,n.loadBtn=$("#load-more-btn"),template.defaults.imports.timeSince=function(n){var e=new Date(n),t=e.getTime(),r=(new Date).getTime();console.log(t,r);var i=(r-t)/1e3;return console.log(i),i<60?"刚刚":60<=i&&i<3600?parseInt(i/60)+"分钟前":3600<=i&&i<86400?parseInt(i/60/60)+"小时前":86400<=i&&i<2592e3?parseInt(i/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+"/"+e.getMinutes()}}Banner.prototype.initBanner=function(){var n=this,e=n.liList.eq(0).clone(),t=n.liList.eq(n.bannerCount-1).clone();n.bannerUl.append(e),n.bannerUl.prepend(t),this.bannerUl.css({width:this.bannerWidth*(n.bannerCount+2),left:-n.bannerWidth})},Banner.prototype.initPageControl=function(){for(var n=this,e=0;e<n.bannerCount;e++){var t=$("<li></li>");n.pageControl.append(t),0===e&&t.addClass("active")}n.pageControl.css({width:12*n.bannerCount+30*n.bannerCount})},Banner.prototype.toggleArrow=function(n){var e=this;n?(e.leftArrow.toggle(),e.rightArrow.toggle()):(e.leftArrow.hide(),e.rightArrow.hide())},Banner.prototype.animate=function(){var n=this;this.bannerUl.animate({left:-n.bannerWidth*n.index},1e3);var e=0===(e=n.index)?n.bannerCount-1:e===n.bannerCount+1?0:n.index-1;n.pageControl.children("li").eq(e).addClass("active").siblings().removeClass()},Banner.prototype.loop=function(){var n=this;n.timer=setInterval(function(){n.index>=n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index+=1,n.animate()},2e3)},Banner.prototype.listenArrowClick=function(){var n=this;n.leftArrow.click(function(){0===n.index?(n.bannerUl.css({left:-n.bannerCount*n.bannerWidth}),n.index=n.bannerCount-1):n.index--,n.animate()}),n.rightArrow.click(function(){n.index===n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index++,n.animate()})},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){clearInterval(n.timer),n.toggleArrow(!0)},function(){n.loop(),n.toggleArrow(!1)})},Banner.prototype.listenPageControl=function(){var t=this;t.pageControl.children("li").each(function(n,e){$(e).click(function(){t.index=n+1,t.animate()})})},Banner.prototype.run=function(){this.initBanner(),this.initPageControl(),this.loop(),this.listenBannerHover(),this.listenArrowClick(),this.listenPageControl()},Index.prototype.listenLoadMoreEvent=function(){var r=this;r.loadBtn.click(function(){sdbuajax.get({url:"/news/list/",data:{p:r.page,category_id:r.category_id},success:function(n){var e,t;200===n.code&&(0<(e=n.data).length?(t=template("news-item",{newses:e}),$(".list-inner-group").append(t),r.page+=1):document.getElementById("load-more-btn").innerHTML="我也是有底线的")}})})},Index.prototype.listenCategorySwitchEvent=function(){var a=this;$(".list-tab").children().click(function(){var i=$(this),o=i.attr("data-category");sdbuajax.get({url:"/news/list/",data:{category_id:o,p:1},success:function(n){var e,t,r;200===n.code&&(e=n.data,t=template("news-item",{newses:e}),$(".list-inner-group"),(r=$(".list-inner-group")).empty(),r.append(t),a.page=2,a.category_id=o,i.addClass("active").siblings().removeClass(),a.loadBtn.show(),document.getElementById("load-more-btn").innerHTML="加载更多")}})})},Index.prototype.run=function(){this.listenLoadMoreEvent(),this.listenCategorySwitchEvent()},$(function(){(new Banner).run(),(new Index).run()});